(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('rxjs/operators'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('ng2-bs3-modal', ['exports', '@angular/core', 'rxjs', 'rxjs/operators', '@angular/common'], factory) :
    (factory((global['ng2-bs3-modal'] = {}),global.ng.core,global.rxjs,global.rxjs.operators,global.ng.common));
}(this, (function (exports,core,rxjs,operators,common) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @enum {number} */
    var BsModalHideType = {
        Close: 0,
        Dismiss: 1,
        Backdrop: 2,
        Keyboard: 3,
        RouteChange: 4,
        Destroy: 5,
    };
    BsModalHideType[BsModalHideType.Close] = 'Close';
    BsModalHideType[BsModalHideType.Dismiss] = 'Dismiss';
    BsModalHideType[BsModalHideType.Backdrop] = 'Backdrop';
    BsModalHideType[BsModalHideType.Keyboard] = 'Keyboard';
    BsModalHideType[BsModalHideType.RouteChange] = 'RouteChange';
    BsModalHideType[BsModalHideType.Destroy] = 'Destroy';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var BsModalSize = (function () {
        function BsModalSize() {
        }
        /**
         * @param {?} size
         * @return {?}
         */
        BsModalSize.isValidSize = /**
         * @param {?} size
         * @return {?}
         */
            function (size) {
                return size && (size === BsModalSize.Small || size === BsModalSize.Large);
            };
        BsModalSize.Small = 'sm';
        BsModalSize.Large = 'lg';
        return BsModalSize;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var EVENT_SUFFIX = 'ng2-bs3-modal';
    /** @type {?} */
    var KEYUP_EVENT_NAME = "keyup." + EVENT_SUFFIX;
    /** @type {?} */
    var CLICK_EVENT_NAME = "click." + EVENT_SUFFIX;
    /** @type {?} */
    var SHOW_EVENT_NAME = "show.bs.modal." + EVENT_SUFFIX;
    var BsModalService = (function () {
        function BsModalService() {
            var _this = this;
            this.modals = [];
            this.$body = jQuery(document.body);
            this.onBackdropClose$ = rxjs.fromEvent(this.$body, CLICK_EVENT_NAME).pipe(operators.filter(function (e) { return jQuery(e.target).is('.modal'); }), operators.map(function () { return BsModalHideType.Backdrop; }), operators.share());
            this.onKeyboardClose$ = rxjs.fromEvent(this.$body, KEYUP_EVENT_NAME).pipe(operators.filter(function (e) { return e.which === 27; }), operators.map(function () { return BsModalHideType.Keyboard; }), operators.share());
            this.onModalStack$ = rxjs.fromEvent(this.$body, SHOW_EVENT_NAME).pipe(operators.tap(function () {
                /** @type {?} */
                var zIndex = 1040 + (10 * jQuery('.modal:visible').length);
                jQuery(_this).css('z-index', zIndex);
                setTimeout(function () {
                    jQuery('.modal-backdrop').not('.modal-stack').css('z-index', zIndex - 1).addClass('modal-stack');
                }, 0);
            }), operators.share());
        }
        /**
         * @param {?} modal
         * @return {?}
         */
        BsModalService.prototype.add = /**
         * @param {?} modal
         * @return {?}
         */
            function (modal) {
                this.modals.push(modal);
            };
        /**
         * @param {?} modal
         * @return {?}
         */
        BsModalService.prototype.remove = /**
         * @param {?} modal
         * @return {?}
         */
            function (modal) {
                /** @type {?} */
                var index = this.modals.indexOf(modal);
                if (index > -1) {
                    this.modals.splice(index, 1);
                }
            };
        /**
         * @return {?}
         */
        BsModalService.prototype.focusNext = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var visible = this.modals.filter(function (m) { return m.visible; });
                if (visible.length) {
                    this.$body.addClass('modal-open');
                    visible[visible.length - 1].focus();
                }
            };
        /**
         * @return {?}
         */
        BsModalService.prototype.dismissAll = /**
         * @return {?}
         */
            function () {
                return Promise.all(this.modals.map(function (m) {
                    return m.dismiss();
                }));
            };
        BsModalService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        BsModalService.ctorParameters = function () { return []; };
        return BsModalService;
    }());

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var EVENT_SUFFIX$1 = 'ng2-bs3-modal';
    /** @type {?} */
    var SHOW_EVENT_NAME$1 = "show.bs.modal." + EVENT_SUFFIX$1;
    /** @type {?} */
    var SHOWN_EVENT_NAME = "shown.bs.modal." + EVENT_SUFFIX$1;
    /** @type {?} */
    var HIDE_EVENT_NAME = "hide.bs.modal." + EVENT_SUFFIX$1;
    /** @type {?} */
    var HIDDEN_EVENT_NAME = "hidden.bs.modal." + EVENT_SUFFIX$1;
    /** @type {?} */
    var LOADED_EVENT_NAME = "loaded.bs.modal." + EVENT_SUFFIX$1;
    /** @type {?} */
    var DATA_KEY = 'bs.modal';
    var BsModalComponent = (function () {
        function BsModalComponent(element, service, zone) {
            var _this = this;
            this.element = element;
            this.service = service;
            this.zone = zone;
            this.overrideSize = null;
            this.onInternalClose$ = new rxjs.Subject();
            this.subscriptions = [];
            this.visible = false;
            this.showing = false;
            this.hiding = false;
            this.animation = true;
            this.backdrop = true;
            this.keyboard = true;
            this.onShow = new core.EventEmitter();
            this.onOpen = new core.EventEmitter();
            this.onHide = new core.EventEmitter();
            this.onClose = new core.EventEmitter();
            this.onDismiss = new core.EventEmitter();
            this.onLoaded = new core.EventEmitter();
            this.setVisible = function (isVisible) {
                return function () {
                    _this.visible = isVisible;
                    _this.showing = false;
                    _this.hiding = false;
                };
            };
            this.setOptions = function (options) {
                /** @type {?} */
                var backdrop = options.backdrop;
                if (typeof backdrop === 'string' && backdrop !== 'static') {
                    backdrop = true;
                }
                if (options.backdrop !== undefined) {
                    _this.options.backdrop = backdrop;
                }
                if (options.keyboard !== undefined) {
                    _this.options.keyboard = options.keyboard;
                }
            };
            this.service.add(this);
            this.init();
        }
        Object.defineProperty(BsModalComponent.prototype, "options", {
            get: /**
             * @return {?}
             */ function () {
                if (!this.$modal) {
                    this.init();
                }
                return this.$modal.data(DATA_KEY).options;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BsModalComponent.prototype, "fadeClass", {
            get: /**
             * @return {?}
             */ function () { return this.animation; },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BsModalComponent.prototype, "modalClass", {
            get: /**
             * @return {?}
             */ function () { return true; },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BsModalComponent.prototype, "roleAttr", {
            get: /**
             * @return {?}
             */ function () { return 'dialog'; },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BsModalComponent.prototype, "tabindexAttr", {
            get: /**
             * @return {?}
             */ function () { return '-1'; },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        BsModalComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this.wireUpEventEmitters();
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.ngAfterViewInit = /**
         * @return {?}
         */
            function () {
                this.$dialog = this.$modal.find('.modal-dialog');
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.ngOnChanges = /**
         * @return {?}
         */
            function () {
                this.setOptions({
                    backdrop: this.backdrop,
                    keyboard: this.keyboard
                });
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.onInternalClose$.next(BsModalHideType.Destroy);
                return this.destroy();
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.focus = /**
         * @return {?}
         */
            function () {
                this.$modal.trigger('focus');
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.routerCanDeactivate = /**
         * @return {?}
         */
            function () {
                this.onInternalClose$.next(BsModalHideType.RouteChange);
                return this.destroy();
            };
        /**
         * @param {?=} size
         * @return {?}
         */
        BsModalComponent.prototype.open = /**
         * @param {?=} size
         * @return {?}
         */
            function (size) {
                this.overrideSize = null;
                if (BsModalSize.isValidSize(size)) {
                    this.overrideSize = size;
                }
                return this.show().toPromise();
            };
        /**
         * @param {?=} value
         * @return {?}
         */
        BsModalComponent.prototype.close = /**
         * @param {?=} value
         * @return {?}
         */
            function (value) {
                var _this = this;
                this.onInternalClose$.next(BsModalHideType.Close);
                return this.hide().pipe(operators.tap(function () { return _this.onClose.emit(value); })).toPromise().then(function () { return value; });
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.dismiss = /**
         * @return {?}
         */
            function () {
                this.onInternalClose$.next(BsModalHideType.Dismiss);
                return this.hide().toPromise();
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.getCssClasses = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var classes = [];
                if (this.isSmall()) {
                    classes.push('modal-sm');
                }
                if (this.isLarge()) {
                    classes.push('modal-lg');
                }
                if (this.cssClass) {
                    classes.push(this.cssClass);
                }
                return classes.join(' ');
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.isSmall = /**
         * @return {?}
         */
            function () {
                return this.overrideSize !== BsModalSize.Large
                    && this.size === BsModalSize.Small
                    || this.overrideSize === BsModalSize.Small;
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.isLarge = /**
         * @return {?}
         */
            function () {
                return this.overrideSize !== BsModalSize.Small
                    && this.size === BsModalSize.Large
                    || this.overrideSize === BsModalSize.Large;
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.show = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.visible && !this.hiding) {
                    return rxjs.of(null);
                }
                this.showing = true;
                return rxjs.Observable.create(function (o) {
                    _this.onShown$.pipe(operators.take(1)).subscribe(function (next) {
                        o.next(next);
                        o.complete();
                    });
                    _this.transitionFix();
                    _this.$modal.modal('show');
                });
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.transitionFix = /**
         * @return {?}
         */
            function () {
                var _this = this;
                // Fix for shown.bs.modal not firing when .fade is present
                // https://github.com/twbs/bootstrap/issues/11793
                if (this.animation) {
                    setTimeout(function () {
                        _this.$modal.trigger('focus').trigger(SHOWN_EVENT_NAME);
                    }, jQuery.fn.modal['Constructor'].TRANSITION_DURATION);
                }
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.hide = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (!this.visible && !this.showing) {
                    return rxjs.of(null);
                }
                this.hiding = true;
                return rxjs.Observable.create(function (o) {
                    _this.onHidden$.pipe(operators.take(1)).subscribe(function (next) {
                        o.next(next);
                        o.complete();
                    });
                    _this.$modal.modal('hide');
                });
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.init = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.$modal = jQuery(this.element.nativeElement);
                this.$modal.appendTo(document.body);
                this.$modal.modal({
                    show: false
                });
                this.onShowEvent$ = rxjs.fromEvent(this.$modal, SHOW_EVENT_NAME$1);
                this.onShownEvent$ = rxjs.fromEvent(this.$modal, SHOWN_EVENT_NAME);
                this.onHideEvent$ = rxjs.fromEvent(this.$modal, HIDE_EVENT_NAME);
                this.onHiddenEvent$ = rxjs.fromEvent(this.$modal, HIDDEN_EVENT_NAME);
                this.onLoadedEvent$ = rxjs.fromEvent(this.$modal, LOADED_EVENT_NAME);
                /** @type {?} */
                var onClose$ = rxjs.merge(this.onInternalClose$, this.service.onBackdropClose$, this.service.onKeyboardClose$);
                this.onHide$ = rxjs.zip(this.onHideEvent$, onClose$).pipe(operators.map(function (x) { return ({ event: x[0], type: x[1] }); }));
                this.onHidden$ = rxjs.zip(this.onHiddenEvent$, onClose$).pipe(operators.map(function (x) { return x[1]; }), operators.tap(this.setVisible(false)), operators.tap(function () { return _this.service.focusNext(); }), operators.share());
                this.onShown$ = this.onShownEvent$.pipe(operators.tap(this.setVisible(true)), operators.share());
                this.onDismiss$ = this.onHidden$.pipe(operators.filter(function (x) { return x !== BsModalHideType.Close; }));
                // Start watching for events
                // Start watching for events
                (_a = this.subscriptions).push.apply(_a, __spread([
                    this.onShown$.subscribe(function () { }),
                    this.onHidden$.subscribe(function () { }),
                    this.service.onModalStack$.subscribe(function () { })
                ]));
                var _a;
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.wireUpEventEmitters = /**
         * @return {?}
         */
            function () {
                this.wireUpEventEmitter(this.onShow, this.onShowEvent$);
                this.wireUpEventEmitter(this.onOpen, this.onShown$);
                this.wireUpEventEmitter(this.onHide, this.onHide$);
                this.wireUpEventEmitter(this.onDismiss, this.onDismiss$);
                this.wireUpEventEmitter(this.onLoaded, this.onLoadedEvent$);
            };
        /**
         * @template T
         * @param {?} emitter
         * @param {?} stream$
         * @return {?}
         */
        BsModalComponent.prototype.wireUpEventEmitter = /**
         * @template T
         * @param {?} emitter
         * @param {?} stream$
         * @return {?}
         */
            function (emitter, stream$) {
                var _this = this;
                if (emitter.observers.length === 0) {
                    return;
                }
                /** @type {?} */
                var sub = stream$.subscribe(function (next) {
                    _this.zone.run(function () {
                        emitter.next(next);
                    });
                });
                this.subscriptions.push(sub);
            };
        /**
         * @return {?}
         */
        BsModalComponent.prototype.destroy = /**
         * @return {?}
         */
            function () {
                var _this = this;
                return this.hide().pipe(operators.tap(function () {
                    _this.service.remove(_this);
                    _this.subscriptions.forEach(function (s) { return s.unsubscribe(); });
                    _this.subscriptions = [];
                    if (_this.$modal) {
                        _this.$modal.data(DATA_KEY, null);
                        _this.$modal.remove();
                        _this.$modal = null;
                    }
                })).toPromise();
            };
        BsModalComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'bs-modal',
                        template: "\n        <div class=\"modal-dialog\" [ngClass]=\"getCssClasses()\">\n            <div class=\"modal-content\">\n                <ng-content></ng-content>\n            </div>\n        </div>\n    "
                    },] },
        ];
        /** @nocollapse */
        BsModalComponent.ctorParameters = function () {
            return [
                { type: core.ElementRef },
                { type: BsModalService },
                { type: core.NgZone }
            ];
        };
        BsModalComponent.propDecorators = {
            animation: [{ type: core.Input }],
            backdrop: [{ type: core.Input }],
            keyboard: [{ type: core.Input }],
            size: [{ type: core.Input }],
            cssClass: [{ type: core.Input }],
            onShow: [{ type: core.Output }],
            onOpen: [{ type: core.Output }],
            onHide: [{ type: core.Output }],
            onClose: [{ type: core.Output }],
            onDismiss: [{ type: core.Output }],
            onLoaded: [{ type: core.Output }],
            fadeClass: [{ type: core.HostBinding, args: ['class.fade',] }],
            modalClass: [{ type: core.HostBinding, args: ['class.modal',] }],
            roleAttr: [{ type: core.HostBinding, args: ['attr.role',] }],
            tabindexAttr: [{ type: core.HostBinding, args: ['attr.tabindex',] }]
        };
        return BsModalComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var BsModalHeaderComponent = (function () {
        function BsModalHeaderComponent(modal) {
            this.modal = modal;
            this.showDismiss = false;
        }
        BsModalHeaderComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'bs-modal-header',
                        template: "\n        <div class=\"modal-header\">\n            <button *ngIf=\"showDismiss\" type=\"button\" class=\"close\" aria-label=\"Dismiss\" (click)=\"modal.dismiss()\">\n                <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <ng-content></ng-content>\n        </div>\n    "
                    },] },
        ];
        /** @nocollapse */
        BsModalHeaderComponent.ctorParameters = function () {
            return [
                { type: BsModalComponent }
            ];
        };
        BsModalHeaderComponent.propDecorators = {
            showDismiss: [{ type: core.Input }]
        };
        return BsModalHeaderComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var BsModalBodyComponent = (function () {
        function BsModalBodyComponent() {
        }
        BsModalBodyComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'bs-modal-body',
                        template: "\n        <div class=\"modal-body\">\n            <ng-content></ng-content>\n        </div>\n    "
                    },] },
        ];
        return BsModalBodyComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var BsModalFooterComponent = (function () {
        function BsModalFooterComponent(modal) {
            this.modal = modal;
            this.showDefaultButtons = false;
            this.dismissButtonLabel = 'Dismiss';
            this.closeButtonLabel = 'Close';
        }
        BsModalFooterComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'bs-modal-footer',
                        template: "\n        <div class=\"modal-footer\">\n            <ng-content></ng-content>\n            <button *ngIf=\"showDefaultButtons\" type=\"button\" class=\"btn btn-default\" (click)=\"modal.dismiss()\">\n                {{dismissButtonLabel}}\n            </button>\n            <button *ngIf=\"showDefaultButtons\" type=\"button\" class=\"btn btn-primary\" (click)=\"modal.close()\">\n                {{closeButtonLabel}}\n              </button>\n        </div>\n    "
                    },] },
        ];
        /** @nocollapse */
        BsModalFooterComponent.ctorParameters = function () {
            return [
                { type: BsModalComponent }
            ];
        };
        BsModalFooterComponent.propDecorators = {
            showDefaultButtons: [{ type: core.Input }],
            dismissButtonLabel: [{ type: core.Input }],
            closeButtonLabel: [{ type: core.Input }]
        };
        return BsModalFooterComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var BsAutofocusDirective = (function () {
        function BsAutofocusDirective(el, modal) {
            var _this = this;
            this.el = el;
            this.modal = modal;
            if (modal) {
                this.modal.onOpen.subscribe(function () {
                    _this.el.nativeElement.focus();
                });
            }
        }
        BsAutofocusDirective.decorators = [
            { type: core.Directive, args: [{
                        // tslint:disable-next-line:directive-selector
                        selector: '[autofocus]'
                    },] },
        ];
        /** @nocollapse */
        BsAutofocusDirective.ctorParameters = function () {
            return [
                { type: core.ElementRef },
                { type: BsModalComponent, decorators: [{ type: core.Optional }] }
            ];
        };
        return BsAutofocusDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var BsModalModule = (function () {
        function BsModalModule() {
        }
        BsModalModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule
                        ],
                        declarations: [
                            BsModalComponent,
                            BsModalHeaderComponent,
                            BsModalBodyComponent,
                            BsModalFooterComponent,
                            BsAutofocusDirective
                        ],
                        providers: [
                            BsModalService
                        ],
                        exports: [
                            BsModalComponent,
                            BsModalHeaderComponent,
                            BsModalBodyComponent,
                            BsModalFooterComponent,
                            BsAutofocusDirective
                        ]
                    },] },
        ];
        return BsModalModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.BsModalService = BsModalService;
    exports.BsModalComponent = BsModalComponent;
    exports.BsModalHeaderComponent = BsModalHeaderComponent;
    exports.BsModalBodyComponent = BsModalBodyComponent;
    exports.BsModalFooterComponent = BsModalFooterComponent;
    exports.BsModalHideType = BsModalHideType;
    exports.BsModalSize = BsModalSize;
    exports.BsModalModule = BsModalModule;
    exports.ɵa = BsAutofocusDirective;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmcyLWJzMy1tb2RhbC51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL25nMi1iczMtbW9kYWwvbW9kYWwvbW9kZWxzL21vZGFsLWhpZGUtdHlwZS50cyIsIm5nOi8vbmcyLWJzMy1tb2RhbC9tb2RhbC9tb2RlbHMvbW9kYWwtc2l6ZS50cyIsIm5nOi8vbmcyLWJzMy1tb2RhbC9tb2RhbC9tb2RhbC5zZXJ2aWNlLnRzIixudWxsLCJuZzovL25nMi1iczMtbW9kYWwvbW9kYWwvbW9kYWwuY29tcG9uZW50LnRzIiwibmc6Ly9uZzItYnMzLW1vZGFsL21vZGFsL2hlYWRlci5jb21wb25lbnQudHMiLCJuZzovL25nMi1iczMtbW9kYWwvbW9kYWwvYm9keS5jb21wb25lbnQudHMiLCJuZzovL25nMi1iczMtbW9kYWwvbW9kYWwvZm9vdGVyLmNvbXBvbmVudC50cyIsIm5nOi8vbmcyLWJzMy1tb2RhbC9hdXRvZm9jdXMvYXV0b2ZvY3VzLmRpcmVjdGl2ZS50cyIsIm5nOi8vbmcyLWJzMy1tb2RhbC9tb2RhbC5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGVudW0gQnNNb2RhbEhpZGVUeXBlIHtcbiAgICBDbG9zZSxcbiAgICBEaXNtaXNzLFxuICAgIEJhY2tkcm9wLFxuICAgIEtleWJvYXJkLFxuICAgIFJvdXRlQ2hhbmdlLFxuICAgIERlc3Ryb3lcbn1cbiIsImV4cG9ydCBjbGFzcyBCc01vZGFsU2l6ZSB7XG4gICAgc3RhdGljIFNtYWxsID0gJ3NtJztcbiAgICBzdGF0aWMgTGFyZ2UgPSAnbGcnO1xuXG4gICAgc3RhdGljIGlzVmFsaWRTaXplKHNpemU6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gc2l6ZSAmJiAoc2l6ZSA9PT0gQnNNb2RhbFNpemUuU21hbGwgfHwgc2l6ZSA9PT0gQnNNb2RhbFNpemUuTGFyZ2UpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIGZyb21FdmVudCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyLCBtYXAsIHNoYXJlLCB0YXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IEJzTW9kYWxDb21wb25lbnQgfSBmcm9tICcuL21vZGFsLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBCc01vZGFsSGlkZVR5cGUgfSBmcm9tICcuL21vZGVscyc7XG5cbmNvbnN0IEVWRU5UX1NVRkZJWCA9ICduZzItYnMzLW1vZGFsJztcbmNvbnN0IEtFWVVQX0VWRU5UX05BTUUgPSBga2V5dXAuJHtFVkVOVF9TVUZGSVh9YDtcbmNvbnN0IENMSUNLX0VWRU5UX05BTUUgPSBgY2xpY2suJHtFVkVOVF9TVUZGSVh9YDtcbmNvbnN0IFNIT1dfRVZFTlRfTkFNRSA9IGBzaG93LmJzLm1vZGFsLiR7RVZFTlRfU1VGRklYfWA7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBCc01vZGFsU2VydmljZSB7XG5cbiAgICBwcml2YXRlIG1vZGFsczogQnNNb2RhbENvbXBvbmVudFtdID0gW107XG4gICAgcHJpdmF0ZSAkYm9keTogSlF1ZXJ5O1xuXG4gICAgb25CYWNrZHJvcENsb3NlJDogT2JzZXJ2YWJsZTxCc01vZGFsSGlkZVR5cGU+O1xuICAgIG9uS2V5Ym9hcmRDbG9zZSQ6IE9ic2VydmFibGU8QnNNb2RhbEhpZGVUeXBlPjtcbiAgICBvbk1vZGFsU3RhY2skOiBPYnNlcnZhYmxlPEV2ZW50PjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLiRib2R5ID0galF1ZXJ5KGRvY3VtZW50LmJvZHkpO1xuXG4gICAgICAgIHRoaXMub25CYWNrZHJvcENsb3NlJCA9IGZyb21FdmVudCh0aGlzLiRib2R5LCBDTElDS19FVkVOVF9OQU1FKS5waXBlKFxuICAgICAgICAgICAgZmlsdGVyKChlOiBNb3VzZUV2ZW50KSA9PiBqUXVlcnkoZS50YXJnZXQpLmlzKCcubW9kYWwnKSksXG4gICAgICAgICAgICBtYXAoKCkgPT4gQnNNb2RhbEhpZGVUeXBlLkJhY2tkcm9wKSxcbiAgICAgICAgICAgIHNoYXJlKCksXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5vbktleWJvYXJkQ2xvc2UkID0gZnJvbUV2ZW50KHRoaXMuJGJvZHksIEtFWVVQX0VWRU5UX05BTUUpLnBpcGUoXG4gICAgICAgICAgICBmaWx0ZXIoKGU6IEtleWJvYXJkRXZlbnQpID0+IGUud2hpY2ggPT09IDI3KSxcbiAgICAgICAgICAgIG1hcCgoKSA9PiBCc01vZGFsSGlkZVR5cGUuS2V5Ym9hcmQpLFxuICAgICAgICAgICAgc2hhcmUoKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMub25Nb2RhbFN0YWNrJCA9IGZyb21FdmVudDxFdmVudD4odGhpcy4kYm9keSwgU0hPV19FVkVOVF9OQU1FKS5waXBlKFxuICAgICAgICAgICAgdGFwKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB6SW5kZXggPSAxMDQwICsgKDEwICogalF1ZXJ5KCcubW9kYWw6dmlzaWJsZScpLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KHRoaXMpLmNzcygnei1pbmRleCcsIHpJbmRleCk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgalF1ZXJ5KCcubW9kYWwtYmFja2Ryb3AnKS5ub3QoJy5tb2RhbC1zdGFjaycpLmNzcygnei1pbmRleCcsIHpJbmRleCAtIDEpLmFkZENsYXNzKCdtb2RhbC1zdGFjaycpO1xuICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzaGFyZSgpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgYWRkKG1vZGFsOiBCc01vZGFsQ29tcG9uZW50KSB7XG4gICAgICAgIHRoaXMubW9kYWxzLnB1c2gobW9kYWwpO1xuICAgIH1cblxuICAgIHJlbW92ZShtb2RhbDogQnNNb2RhbENvbXBvbmVudCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMubW9kYWxzLmluZGV4T2YobW9kYWwpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5tb2RhbHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvY3VzTmV4dCgpIHtcbiAgICAgICAgY29uc3QgdmlzaWJsZSA9IHRoaXMubW9kYWxzLmZpbHRlcihtID0+IG0udmlzaWJsZSk7XG4gICAgICAgIGlmICh2aXNpYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy4kYm9keS5hZGRDbGFzcygnbW9kYWwtb3BlbicpO1xuICAgICAgICAgICAgdmlzaWJsZVt2aXNpYmxlLmxlbmd0aCAtIDFdLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkaXNtaXNzQWxsKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwodGhpcy5tb2RhbHMubWFwKChtKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbS5kaXNtaXNzKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG4iLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsIi8vIHRzbGludDpkaXNhYmxlOm5vLW91dHB1dC1vbi1wcmVmaXhcbmltcG9ydCB7XG4gICAgQ29tcG9uZW50LFxuICAgIE9uSW5pdCxcbiAgICBBZnRlclZpZXdJbml0LFxuICAgIE9uQ2hhbmdlcyxcbiAgICBPbkRlc3Ryb3ksXG4gICAgSW5wdXQsXG4gICAgT3V0cHV0LFxuICAgIEV2ZW50RW1pdHRlcixcbiAgICBFbGVtZW50UmVmLFxuICAgIEhvc3RCaW5kaW5nLFxuICAgIE5nWm9uZVxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIE9ic2VydmVyLCBTdWJqZWN0LCBTdWJzY3JpcHRpb24sIG9mIGFzIG9ic2VydmFibGVPZiwgZnJvbUV2ZW50LCBtZXJnZSwgemlwIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlLCBmaWx0ZXIsIHRhcCwgc2hhcmUsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgQnNNb2RhbEhpZGVFdmVudCwgQnNNb2RhbEhpZGVUeXBlLCBCc01vZGFsT3B0aW9ucywgQnNNb2RhbFNpemUgfSBmcm9tICcuL21vZGVscyc7XG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJy4vbW9kYWwuc2VydmljZSc7XG5cbmNvbnN0IEVWRU5UX1NVRkZJWCA9ICduZzItYnMzLW1vZGFsJztcbmNvbnN0IFNIT1dfRVZFTlRfTkFNRSA9IGBzaG93LmJzLm1vZGFsLiR7RVZFTlRfU1VGRklYfWA7XG5jb25zdCBTSE9XTl9FVkVOVF9OQU1FID0gYHNob3duLmJzLm1vZGFsLiR7RVZFTlRfU1VGRklYfWA7XG5jb25zdCBISURFX0VWRU5UX05BTUUgPSBgaGlkZS5icy5tb2RhbC4ke0VWRU5UX1NVRkZJWH1gO1xuY29uc3QgSElEREVOX0VWRU5UX05BTUUgPSBgaGlkZGVuLmJzLm1vZGFsLiR7RVZFTlRfU1VGRklYfWA7XG5jb25zdCBMT0FERURfRVZFTlRfTkFNRSA9IGBsb2FkZWQuYnMubW9kYWwuJHtFVkVOVF9TVUZGSVh9YDtcbmNvbnN0IERBVEFfS0VZID0gJ2JzLm1vZGFsJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdicy1tb2RhbCcsXG4gICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWRpYWxvZ1wiIFtuZ0NsYXNzXT1cImdldENzc0NsYXNzZXMoKVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxufSlcbmV4cG9ydCBjbGFzcyBCc01vZGFsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XG5cbiAgICBwcml2YXRlIG92ZXJyaWRlU2l6ZTogc3RyaW5nID0gbnVsbDtcbiAgICBwcml2YXRlICRtb2RhbDogSlF1ZXJ5O1xuICAgIHByaXZhdGUgJGRpYWxvZzogSlF1ZXJ5O1xuICAgIHByaXZhdGUgb25TaG93RXZlbnQkOiBPYnNlcnZhYmxlPEV2ZW50PjtcbiAgICBwcml2YXRlIG9uU2hvd25FdmVudCQ6IE9ic2VydmFibGU8RXZlbnQ+O1xuICAgIHByaXZhdGUgb25IaWRlRXZlbnQkOiBPYnNlcnZhYmxlPEV2ZW50PjtcbiAgICBwcml2YXRlIG9uSGlkZGVuRXZlbnQkOiBPYnNlcnZhYmxlPEV2ZW50PjtcbiAgICBwcml2YXRlIG9uTG9hZGVkRXZlbnQkOiBPYnNlcnZhYmxlPEV2ZW50PjtcbiAgICBwcml2YXRlIG9uU2hvd24kOiBPYnNlcnZhYmxlPHt9PjtcbiAgICBwcml2YXRlIG9uSW50ZXJuYWxDbG9zZSQ6IFN1YmplY3Q8QnNNb2RhbEhpZGVUeXBlPiA9IG5ldyBTdWJqZWN0PEJzTW9kYWxIaWRlVHlwZT4oKTtcbiAgICBwcml2YXRlIG9uRGlzbWlzcyQ6IE9ic2VydmFibGU8QnNNb2RhbEhpZGVUeXBlPjtcbiAgICBwcml2YXRlIG9uSGlkZSQ6IE9ic2VydmFibGU8QnNNb2RhbEhpZGVFdmVudD47XG4gICAgcHJpdmF0ZSBvbkhpZGRlbiQ6IE9ic2VydmFibGU8QnNNb2RhbEhpZGVUeXBlPjtcbiAgICBwcml2YXRlIHN1YnNjcmlwdGlvbnM6IFN1YnNjcmlwdGlvbltdID0gW107XG4gICAgcHJpdmF0ZSBnZXQgb3B0aW9ucygpIHtcbiAgICAgICAgaWYgKCF0aGlzLiRtb2RhbCkge1xuICAgICAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuJG1vZGFsLmRhdGEoREFUQV9LRVkpLm9wdGlvbnM7XG4gICAgfVxuXG4gICAgdmlzaWJsZSA9IGZhbHNlO1xuICAgIHNob3dpbmcgPSBmYWxzZTtcbiAgICBoaWRpbmcgPSBmYWxzZTtcblxuICAgIEBJbnB1dCgpIGFuaW1hdGlvbiA9IHRydWU7XG4gICAgQElucHV0KCkgYmFja2Ryb3A6IHN0cmluZyB8IGJvb2xlYW4gPSB0cnVlO1xuICAgIEBJbnB1dCgpIGtleWJvYXJkID0gdHJ1ZTtcbiAgICBASW5wdXQoKSBzaXplOiBzdHJpbmc7XG4gICAgQElucHV0KCkgY3NzQ2xhc3M6IHN0cmluZztcblxuICAgIEBPdXRwdXQoKSBvblNob3cgPSBuZXcgRXZlbnRFbWl0dGVyPEV2ZW50PigpO1xuICAgIEBPdXRwdXQoKSBvbk9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgICBAT3V0cHV0KCkgb25IaWRlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICAgQE91dHB1dCgpIG9uQ2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgICBAT3V0cHV0KCkgb25EaXNtaXNzID0gbmV3IEV2ZW50RW1pdHRlcjxCc01vZGFsSGlkZVR5cGU+KCk7XG4gICAgQE91dHB1dCgpIG9uTG9hZGVkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZhZGUnKVxuICAgIGdldCBmYWRlQ2xhc3MoKSB7IHJldHVybiB0aGlzLmFuaW1hdGlvbjsgfVxuXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5tb2RhbCcpXG4gICAgZ2V0IG1vZGFsQ2xhc3MoKSB7IHJldHVybiB0cnVlOyB9XG5cbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIucm9sZScpXG4gICAgZ2V0IHJvbGVBdHRyKCkgeyByZXR1cm4gJ2RpYWxvZyc7IH1cblxuICAgIEBIb3N0QmluZGluZygnYXR0ci50YWJpbmRleCcpXG4gICAgZ2V0IHRhYmluZGV4QXR0cigpIHsgcmV0dXJuICctMSc7IH1cblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZiwgcHJpdmF0ZSBzZXJ2aWNlOiBCc01vZGFsU2VydmljZSwgcHJpdmF0ZSB6b25lOiBOZ1pvbmUpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlLmFkZCh0aGlzKTtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMud2lyZVVwRXZlbnRFbWl0dGVycygpO1xuICAgIH1cblxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgdGhpcy4kZGlhbG9nID0gdGhpcy4kbW9kYWwuZmluZCgnLm1vZGFsLWRpYWxvZycpO1xuICAgIH1cblxuICAgIG5nT25DaGFuZ2VzKCkge1xuICAgICAgICB0aGlzLnNldE9wdGlvbnMoe1xuICAgICAgICAgICAgYmFja2Ryb3A6IHRoaXMuYmFja2Ryb3AsXG4gICAgICAgICAgICBrZXlib2FyZDogdGhpcy5rZXlib2FyZFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5vbkludGVybmFsQ2xvc2UkLm5leHQoQnNNb2RhbEhpZGVUeXBlLkRlc3Ryb3kpO1xuICAgICAgICByZXR1cm4gdGhpcy5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgZm9jdXMoKSB7XG4gICAgICAgIHRoaXMuJG1vZGFsLnRyaWdnZXIoJ2ZvY3VzJyk7XG4gICAgfVxuXG4gICAgcm91dGVyQ2FuRGVhY3RpdmF0ZSgpOiBhbnkge1xuICAgICAgICB0aGlzLm9uSW50ZXJuYWxDbG9zZSQubmV4dChCc01vZGFsSGlkZVR5cGUuUm91dGVDaGFuZ2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgb3BlbihzaXplPzogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMub3ZlcnJpZGVTaXplID0gbnVsbDtcbiAgICAgICAgaWYgKEJzTW9kYWxTaXplLmlzVmFsaWRTaXplKHNpemUpKSB7XG4gICAgICAgICAgICB0aGlzLm92ZXJyaWRlU2l6ZSA9IHNpemU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc2hvdygpLnRvUHJvbWlzZSgpO1xuICAgIH1cblxuICAgIGNsb3NlKHZhbHVlPzogYW55KTogUHJvbWlzZTx7fT4ge1xuICAgICAgICB0aGlzLm9uSW50ZXJuYWxDbG9zZSQubmV4dChCc01vZGFsSGlkZVR5cGUuQ2xvc2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5oaWRlKCkucGlwZShcbiAgICAgICAgICAgIHRhcCgoKSA9PiB0aGlzLm9uQ2xvc2UuZW1pdCh2YWx1ZSkpLFxuICAgICAgICApLnRvUHJvbWlzZSgpLnRoZW4oKCkgPT4gdmFsdWUpO1xuICAgIH1cblxuICAgIGRpc21pc3MoKTogUHJvbWlzZTx7fT4ge1xuICAgICAgICB0aGlzLm9uSW50ZXJuYWxDbG9zZSQubmV4dChCc01vZGFsSGlkZVR5cGUuRGlzbWlzcyk7XG4gICAgICAgIHJldHVybiB0aGlzLmhpZGUoKS50b1Byb21pc2UoKTtcbiAgICB9XG5cbiAgICBnZXRDc3NDbGFzc2VzKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMuaXNTbWFsbCgpKSB7XG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goJ21vZGFsLXNtJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pc0xhcmdlKCkpIHtcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaCgnbW9kYWwtbGcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmNzc0NsYXNzKSB7XG4gICAgICAgICAgICBjbGFzc2VzLnB1c2godGhpcy5jc3NDbGFzcyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2xhc3Nlcy5qb2luKCcgJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc1NtYWxsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdmVycmlkZVNpemUgIT09IEJzTW9kYWxTaXplLkxhcmdlXG4gICAgICAgICAgICAmJiB0aGlzLnNpemUgPT09IEJzTW9kYWxTaXplLlNtYWxsXG4gICAgICAgICAgICB8fCB0aGlzLm92ZXJyaWRlU2l6ZSA9PT0gQnNNb2RhbFNpemUuU21hbGw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0xhcmdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdmVycmlkZVNpemUgIT09IEJzTW9kYWxTaXplLlNtYWxsXG4gICAgICAgICAgICAmJiB0aGlzLnNpemUgPT09IEJzTW9kYWxTaXplLkxhcmdlXG4gICAgICAgICAgICB8fCB0aGlzLm92ZXJyaWRlU2l6ZSA9PT0gQnNNb2RhbFNpemUuTGFyZ2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93KCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIGlmICh0aGlzLnZpc2libGUgJiYgIXRoaXMuaGlkaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZU9mKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2hvd2luZyA9IHRydWU7XG5cbiAgICAgICAgcmV0dXJuIE9ic2VydmFibGUuY3JlYXRlKChvOiBPYnNlcnZlcjxhbnk+KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uU2hvd24kLnBpcGUoXG4gICAgICAgICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICAgICkuc3Vic2NyaWJlKG5leHQgPT4ge1xuICAgICAgICAgICAgICAgIG8ubmV4dChuZXh0KTtcbiAgICAgICAgICAgICAgICBvLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uRml4KCk7XG4gICAgICAgICAgICB0aGlzLiRtb2RhbC5tb2RhbCgnc2hvdycpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRyYW5zaXRpb25GaXgoKSB7XG4gICAgICAgIC8vIEZpeCBmb3Igc2hvd24uYnMubW9kYWwgbm90IGZpcmluZyB3aGVuIC5mYWRlIGlzIHByZXNlbnRcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2lzc3Vlcy8xMTc5M1xuICAgICAgICBpZiAodGhpcy5hbmltYXRpb24pIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuJG1vZGFsLnRyaWdnZXIoJ2ZvY3VzJykudHJpZ2dlcihTSE9XTl9FVkVOVF9OQU1FKTtcbiAgICAgICAgICAgIH0sIGpRdWVyeS5mbi5tb2RhbFsnQ29uc3RydWN0b3InXS5UUkFOU0lUSU9OX0RVUkFUSU9OKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGlkZSgpOiBPYnNlcnZhYmxlPEJzTW9kYWxIaWRlVHlwZT4ge1xuICAgICAgICBpZiAoIXRoaXMudmlzaWJsZSAmJiAhdGhpcy5zaG93aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZU9mPEJzTW9kYWxIaWRlVHlwZT4obnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oaWRpbmcgPSB0cnVlO1xuXG4gICAgICAgIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZSgobzogT2JzZXJ2ZXI8YW55PikgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkhpZGRlbiQucGlwZShcbiAgICAgICAgICAgICAgICB0YWtlKDEpXG4gICAgICAgICAgICApLnN1YnNjcmliZShuZXh0ID0+IHtcbiAgICAgICAgICAgICAgICBvLm5leHQobmV4dCk7XG4gICAgICAgICAgICAgICAgby5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1vZGFsKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdCgpIHtcbiAgICAgICAgdGhpcy4kbW9kYWwgPSBqUXVlcnkodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgICB0aGlzLiRtb2RhbC5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KTtcbiAgICAgICAgdGhpcy4kbW9kYWwubW9kYWwoe1xuICAgICAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5vblNob3dFdmVudCQgPSBmcm9tRXZlbnQodGhpcy4kbW9kYWwsIFNIT1dfRVZFTlRfTkFNRSk7XG4gICAgICAgIHRoaXMub25TaG93bkV2ZW50JCA9IGZyb21FdmVudCh0aGlzLiRtb2RhbCwgU0hPV05fRVZFTlRfTkFNRSk7XG4gICAgICAgIHRoaXMub25IaWRlRXZlbnQkID0gZnJvbUV2ZW50KHRoaXMuJG1vZGFsLCBISURFX0VWRU5UX05BTUUpO1xuICAgICAgICB0aGlzLm9uSGlkZGVuRXZlbnQkID0gZnJvbUV2ZW50KHRoaXMuJG1vZGFsLCBISURERU5fRVZFTlRfTkFNRSk7XG4gICAgICAgIHRoaXMub25Mb2FkZWRFdmVudCQgPSBmcm9tRXZlbnQodGhpcy4kbW9kYWwsIExPQURFRF9FVkVOVF9OQU1FKTtcblxuICAgICAgICBjb25zdCBvbkNsb3NlJCA9IG1lcmdlKHRoaXMub25JbnRlcm5hbENsb3NlJCwgdGhpcy5zZXJ2aWNlLm9uQmFja2Ryb3BDbG9zZSQsIHRoaXMuc2VydmljZS5vbktleWJvYXJkQ2xvc2UkKTtcblxuICAgICAgICB0aGlzLm9uSGlkZSQgPSB6aXAodGhpcy5vbkhpZGVFdmVudCQsIG9uQ2xvc2UkKS5waXBlKFxuICAgICAgICAgICAgbWFwKHggPT4gPEJzTW9kYWxIaWRlRXZlbnQ+eyBldmVudDogeFswXSwgdHlwZTogeFsxXSB9KSxcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLm9uSGlkZGVuJCA9IHppcDxCc01vZGFsSGlkZVR5cGU+KHRoaXMub25IaWRkZW5FdmVudCQsIG9uQ2xvc2UkKS5waXBlKFxuICAgICAgICAgICAgbWFwKHggPT4geFsxXSksXG4gICAgICAgICAgICB0YXAodGhpcy5zZXRWaXNpYmxlKGZhbHNlKSksXG4gICAgICAgICAgICB0YXAoKCkgPT4gdGhpcy5zZXJ2aWNlLmZvY3VzTmV4dCgpKSxcbiAgICAgICAgICAgIHNoYXJlKCksXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5vblNob3duJCA9IHRoaXMub25TaG93bkV2ZW50JC5waXBlKFxuICAgICAgICAgICAgdGFwKHRoaXMuc2V0VmlzaWJsZSh0cnVlKSksXG4gICAgICAgICAgICBzaGFyZSgpXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5vbkRpc21pc3MkID0gdGhpcy5vbkhpZGRlbiQucGlwZShcbiAgICAgICAgICAgIGZpbHRlcigoeCkgPT4geCAhPT0gQnNNb2RhbEhpZGVUeXBlLkNsb3NlKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFN0YXJ0IHdhdGNoaW5nIGZvciBldmVudHNcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goLi4uW1xuICAgICAgICAgICAgdGhpcy5vblNob3duJC5zdWJzY3JpYmUoKCkgPT4geyB9KSxcbiAgICAgICAgICAgIHRoaXMub25IaWRkZW4kLnN1YnNjcmliZSgoKSA9PiB7IH0pLFxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlLm9uTW9kYWxTdGFjayQuc3Vic2NyaWJlKCgpID0+IHsgfSlcbiAgICAgICAgXSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB3aXJlVXBFdmVudEVtaXR0ZXJzKCkge1xuXG4gICAgICAgIHRoaXMud2lyZVVwRXZlbnRFbWl0dGVyKHRoaXMub25TaG93LCB0aGlzLm9uU2hvd0V2ZW50JCk7XG4gICAgICAgIHRoaXMud2lyZVVwRXZlbnRFbWl0dGVyKHRoaXMub25PcGVuLCB0aGlzLm9uU2hvd24kKTtcbiAgICAgICAgdGhpcy53aXJlVXBFdmVudEVtaXR0ZXIodGhpcy5vbkhpZGUsIHRoaXMub25IaWRlJCk7XG4gICAgICAgIHRoaXMud2lyZVVwRXZlbnRFbWl0dGVyKHRoaXMub25EaXNtaXNzLCB0aGlzLm9uRGlzbWlzcyQpO1xuICAgICAgICB0aGlzLndpcmVVcEV2ZW50RW1pdHRlcih0aGlzLm9uTG9hZGVkLCB0aGlzLm9uTG9hZGVkRXZlbnQkKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHdpcmVVcEV2ZW50RW1pdHRlcjxUPihlbWl0dGVyOiBFdmVudEVtaXR0ZXI8VD4sIHN0cmVhbSQ6IE9ic2VydmFibGU8VD4pIHtcbiAgICAgICAgaWYgKGVtaXR0ZXIub2JzZXJ2ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3ViID0gc3RyZWFtJC5zdWJzY3JpYmUoKG5leHQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIubmV4dChuZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzdWIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0VmlzaWJsZSA9IChpc1Zpc2libGUpID0+IHtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9IGlzVmlzaWJsZTtcbiAgICAgICAgICAgIHRoaXMuc2hvd2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5oaWRpbmcgPSBmYWxzZTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldE9wdGlvbnMgPSAob3B0aW9uczogQnNNb2RhbE9wdGlvbnMpID0+IHtcbiAgICAgICAgbGV0IGJhY2tkcm9wID0gb3B0aW9ucy5iYWNrZHJvcDtcbiAgICAgICAgaWYgKHR5cGVvZiBiYWNrZHJvcCA9PT0gJ3N0cmluZycgJiYgYmFja2Ryb3AgIT09ICdzdGF0aWMnKSB7XG4gICAgICAgICAgICBiYWNrZHJvcCA9IHRydWU7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmJhY2tkcm9wICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5iYWNrZHJvcCA9IGJhY2tkcm9wO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmtleWJvYXJkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5rZXlib2FyZCA9IG9wdGlvbnMua2V5Ym9hcmQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGRlc3Ryb3koKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhpZGUoKS5waXBlKFxuICAgICAgICAgICAgdGFwKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2UucmVtb3ZlKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKHMgPT4gcy51bnN1YnNjcmliZSgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy4kbW9kYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbW9kYWwuZGF0YShEQVRBX0tFWSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJG1vZGFsLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRtb2RhbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKS50b1Byb21pc2UoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCc01vZGFsQ29tcG9uZW50IH0gZnJvbSAnLi9tb2RhbC5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2JzLW1vZGFsLWhlYWRlcicsXG4gICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuICAgICAgICAgICAgPGJ1dHRvbiAqbmdJZj1cInNob3dEaXNtaXNzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBhcmlhLWxhYmVsPVwiRGlzbWlzc1wiIChjbGljayk9XCJtb2RhbC5kaXNtaXNzKClcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBhcmlhLWhpZGRlbj1cInRydWVcIj4mdGltZXM7PC9zcGFuPlxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgICAgIDwvZGl2PlxuICAgIGBcbn0pXG5leHBvcnQgY2xhc3MgQnNNb2RhbEhlYWRlckNvbXBvbmVudCB7XG4gICAgQElucHV0KCkgc2hvd0Rpc21pc3MgPSBmYWxzZTtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgbW9kYWw6IEJzTW9kYWxDb21wb25lbnQpIHsgfVxufVxuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYnMtbW9kYWwtYm9keScsXG4gICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cbiAgICAgICAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxufSlcbmV4cG9ydCBjbGFzcyBCc01vZGFsQm9keUNvbXBvbmVudCB7IH1cbiIsImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEJzTW9kYWxDb21wb25lbnQgfSBmcm9tICcuL21vZGFsLmNvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYnMtbW9kYWwtZm9vdGVyJyxcbiAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+XG4gICAgICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgICAgICAgICA8YnV0dG9uICpuZ0lmPVwic2hvd0RlZmF1bHRCdXR0b25zXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCIgKGNsaWNrKT1cIm1vZGFsLmRpc21pc3MoKVwiPlxuICAgICAgICAgICAgICAgIHt7ZGlzbWlzc0J1dHRvbkxhYmVsfX1cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiAqbmdJZj1cInNob3dEZWZhdWx0QnV0dG9uc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIChjbGljayk9XCJtb2RhbC5jbG9zZSgpXCI+XG4gICAgICAgICAgICAgICAge3tjbG9zZUJ1dHRvbkxhYmVsfX1cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgIGBcbn0pXG5leHBvcnQgY2xhc3MgQnNNb2RhbEZvb3RlckNvbXBvbmVudCB7XG4gICAgQElucHV0KCkgc2hvd0RlZmF1bHRCdXR0b25zID0gZmFsc2U7XG4gICAgQElucHV0KCkgZGlzbWlzc0J1dHRvbkxhYmVsID0gJ0Rpc21pc3MnO1xuICAgIEBJbnB1dCgpIGNsb3NlQnV0dG9uTGFiZWwgPSAnQ2xvc2UnO1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBtb2RhbDogQnNNb2RhbENvbXBvbmVudCkgeyB9XG59XG4iLCJpbXBvcnQgeyBEaXJlY3RpdmUsIEVsZW1lbnRSZWYsIEluamVjdCwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEJzTW9kYWxDb21wb25lbnQgfSBmcm9tICcuLi9tb2RhbC9tb2RhbC5jb21wb25lbnQnO1xuXG5ARGlyZWN0aXZlKHtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGlyZWN0aXZlLXNlbGVjdG9yXG4gICAgc2VsZWN0b3I6ICdbYXV0b2ZvY3VzXSdcbn0pXG5leHBvcnQgY2xhc3MgQnNBdXRvZm9jdXNEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsIEBPcHRpb25hbCgpIHByaXZhdGUgbW9kYWw6IEJzTW9kYWxDb21wb25lbnQpIHtcbiAgICAgICAgaWYgKG1vZGFsKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGFsLm9uT3Blbi5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UgfSBmcm9tICcuL21vZGFsL21vZGFsLnNlcnZpY2UnO1xuaW1wb3J0IHsgQnNNb2RhbENvbXBvbmVudCB9IGZyb20gJy4vbW9kYWwvbW9kYWwuY29tcG9uZW50JztcbmltcG9ydCB7IEJzTW9kYWxIZWFkZXJDb21wb25lbnQgfSBmcm9tICcuL21vZGFsL2hlYWRlci5jb21wb25lbnQnO1xuaW1wb3J0IHsgQnNNb2RhbEJvZHlDb21wb25lbnQgfSBmcm9tICcuL21vZGFsL2JvZHkuY29tcG9uZW50JztcbmltcG9ydCB7IEJzTW9kYWxGb290ZXJDb21wb25lbnQgfSBmcm9tICcuL21vZGFsL2Zvb3Rlci5jb21wb25lbnQnO1xuaW1wb3J0IHsgQnNBdXRvZm9jdXNEaXJlY3RpdmUgfSBmcm9tICcuL2F1dG9mb2N1cy9hdXRvZm9jdXMuZGlyZWN0aXZlJztcblxuQE5nTW9kdWxlKHtcbiAgICBpbXBvcnRzOiBbXG4gICAgICAgIENvbW1vbk1vZHVsZVxuICAgIF0sXG4gICAgZGVjbGFyYXRpb25zOiBbXG4gICAgICAgIEJzTW9kYWxDb21wb25lbnQsXG4gICAgICAgIEJzTW9kYWxIZWFkZXJDb21wb25lbnQsXG4gICAgICAgIEJzTW9kYWxCb2R5Q29tcG9uZW50LFxuICAgICAgICBCc01vZGFsRm9vdGVyQ29tcG9uZW50LFxuICAgICAgICBCc0F1dG9mb2N1c0RpcmVjdGl2ZVxuICAgIF0sXG4gICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIEJzTW9kYWxTZXJ2aWNlXG4gICAgXSxcbiAgICBleHBvcnRzOiBbXG4gICAgICAgIEJzTW9kYWxDb21wb25lbnQsXG4gICAgICAgIEJzTW9kYWxIZWFkZXJDb21wb25lbnQsXG4gICAgICAgIEJzTW9kYWxCb2R5Q29tcG9uZW50LFxuICAgICAgICBCc01vZGFsRm9vdGVyQ29tcG9uZW50LFxuICAgICAgICBCc0F1dG9mb2N1c0RpcmVjdGl2ZVxuICAgIF1cbn0pXG5leHBvcnQgY2xhc3MgQnNNb2RhbE1vZHVsZSB7IH1cbiJdLCJuYW1lcyI6WyJmcm9tRXZlbnQiLCJmaWx0ZXIiLCJtYXAiLCJzaGFyZSIsInRhcCIsIkluamVjdGFibGUiLCJFVkVOVF9TVUZGSVgiLCJTSE9XX0VWRU5UX05BTUUiLCJTdWJqZWN0IiwiRXZlbnRFbWl0dGVyIiwib2JzZXJ2YWJsZU9mIiwiT2JzZXJ2YWJsZSIsInRha2UiLCJtZXJnZSIsInppcCIsIkNvbXBvbmVudCIsIkVsZW1lbnRSZWYiLCJOZ1pvbmUiLCJJbnB1dCIsIk91dHB1dCIsIkhvc3RCaW5kaW5nIiwiRGlyZWN0aXZlIiwiT3B0aW9uYWwiLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O1FBQ0ksUUFBSztRQUNMLFVBQU87UUFDUCxXQUFRO1FBQ1IsV0FBUTtRQUNSLGNBQVc7UUFDWCxVQUFPOztvQ0FMUCxLQUFLO29DQUNMLE9BQU87b0NBQ1AsUUFBUTtvQ0FDUixRQUFRO29DQUNSLFdBQVc7b0NBQ1gsT0FBTzs7Ozs7Ozs7Ozs7OztRQ0ZBLHVCQUFXOzs7O1lBQWxCLFVBQW1CLElBQVk7Z0JBQzNCLE9BQU8sSUFBSSxLQUFLLElBQUksS0FBSyxXQUFXLENBQUMsS0FBSyxJQUFJLElBQUksS0FBSyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDN0U7NEJBTGMsSUFBSTs0QkFDSixJQUFJOzBCQUZ2Qjs7Ozs7Ozs7Ozs7O0FDQUE7SUFPQSxJQUFNLFlBQVksR0FBRyxlQUFlLENBQUM7O0lBQ3JDLElBQU0sZ0JBQWdCLEdBQUcsV0FBUyxZQUFjLENBQUM7O0lBQ2pELElBQU0sZ0JBQWdCLEdBQUcsV0FBUyxZQUFjLENBQUM7O0lBQ2pELElBQU0sZUFBZSxHQUFHLG1CQUFpQixZQUFjLENBQUM7O1FBWXBEO1lBQUEsaUJBeUJDOzBCQWhDb0MsRUFBRTtZQVFuQyxJQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFbkMsSUFBSSxDQUFDLGdCQUFnQixHQUFHQSxjQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLElBQUksQ0FDaEVDLGdCQUFNLENBQUMsVUFBQyxDQUFhLElBQUssT0FBQSxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsR0FBQSxDQUFDLEVBQ3hEQyxhQUFHLENBQUMsY0FBTSxPQUFBLGVBQWUsQ0FBQyxRQUFRLEdBQUEsQ0FBQyxFQUNuQ0MsZUFBSyxFQUFFLENBQ1YsQ0FBQztZ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